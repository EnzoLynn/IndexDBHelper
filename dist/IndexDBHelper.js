!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.IndexDBHelper=t():e.IndexDBHelper=t()}(this,function(){return function(e){function t(a){if(n[a])return n[a].exports;var s=n[a]={exports:{},id:a,loaded:!1};return e[a].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Message=t.DbHelper=void 0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(1),r=a(o),c=function(e){var t=e.success,n=e.msg,a=e.result,s=e.total;return{success:t,msg:n,result:a,total:s}},l=function(){this.localDatabase={},this.localDatabase.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,this.localDatabase.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange,this.localDatabase.IDBTransaction=window.IDBTransaction||window.webkitIDBTransaction,this.localDatabase.indexedDB.onerror=function(e){alert("Database error: "+e.target.errorCode)}};l.prototype.openDatabase=function(e,t,n,a){var s=this,o=1;try{n&&(o=n);var r=s.localDatabase.indexedDB.open(e,o);r.onerror=function(e){a&&a(new c({success:!1,msg:"Database error: "+e.target.errorCode,result:null}))},r.onsuccess=function(e){s.localDatabase.db=e.target.result,a&&a(new c({success:!0,msg:"createObjectStore success",result:null}))},r.onupgradeneeded=function(e){s.localDatabase.db=e.target.result,s.createObjectStore(t,!1,!1,function(){a&&a(new c({success:!0,msg:"upgradeneeded success",result:null}))})}}catch(e){a&&a(new c({success:!1,msg:e,result:null}))}},l.prototype.distoryDatabase=function(e,t){try{var n=this,a=n.localDatabase.indexedDB.deleteDatabase(e);a.onsuccess=function(e){t&&t(new c({success:!0,msg:"Database deleted",result:null})),a.onerror=function(e){t&&t(new c({success:!1,msg:"Database error: "+e.target.errorCode,result:null}))}}}catch(e){t&&t(new c({success:!1,msg:e,result:null}))}},l.prototype.createObjectStore=function(e,t,n,a){try{var s=this,o={keyPath:"id",autoIncrement:!0},l=(0,r.default)(o,t||{}),u=s.localDatabase.db.createObjectStore(e,l);if(n)for(var i=0;i<n.length;i++){var f=n[i];u.createIndex(f.name,f.feild,{unique:f.unique})}u.onsuccess=function(e){a&&a(new c({success:!0,msg:"ok",result:null}))}}catch(e){a&&a(new c({success:!1,msg:e,result:null}))}},l.prototype.find=function(e,t,n,a,o){"function"==typeof t?(o=t,t=null,n=null,a=null):"function"==typeof n?(o=n,n=null,a=null):"function"==typeof a&&(o=a,a=null);try{var r=this,l=r.localDatabase.db.transaction(e,"readwrite"),u=l.objectStore(e);if(null!=r.localDatabase&&null!=r.localDatabase.db){var u=r.localDatabase.db.transaction(e).objectStore(e),i=u.openCursor(),f=[],d=[];i.onsuccess=function(e){var r=e.target.result;if(r){var l=r.value;f.push(l),r.continue()}else{if(t)for(var u=0;u<f.length;u++)for(var i in t){var b=f[u][i];if("object"==s(t[i])){var p=t[i];if("date"==p.type){var D=new Date(p.value),g=new Date(b);if(!(g>=D)){delete f[u];break}}else if(n){if(b.indexOf(t[i])==-1){delete f[u];break}}else if(t[i]!=b){delete f[u];break}}else if(n){if(b.indexOf(t[i])==-1){delete f[u];break}}else if(t[i]!=b){delete f[u];break}}for(var w=0;w<f.length;w++)f[w]&&d.push(f[w]);a&&d.length>a&&d.splice(a-1,d.length-a),o&&o(new c({success:!0,total:f.length,msg:"find success",result:f}))}}}}catch(e){o&&o(new c({success:!1,msg:e,result:null}))}},l.prototype.getById=function(e,t,n){try{var a=this,s=a.localDatabase.db.transaction(e,"readwrite"),o=s.objectStore(e);null!=a.localDatabase&&null!=a.localDatabase.db&&(o.get(t).onsuccess=function(e){n&&n(new c({success:!0,msg:"ok",result:e.target.result}))})}catch(e){n&&n(new c({success:!1,msg:e,result:null}))}},l.prototype.add=function(e,t,n){try{var a=this,s=a.localDatabase.db.transaction(e,"readwrite"),o=s.objectStore(e);if(null!=a.localDatabase&&null!=a.localDatabase.db)for(var r=0;r<t.length;r++){var l=t[r],u=o.add(l);u.onsuccess=function(e){n&&n(new c({success:!0,msg:"ok",result:null}))},u.onerror=function(e){n&&n(new c({success:!1,msg:e,result:null}))}}}catch(e){n&&n(new c({success:!1,msg:e,result:null}))}},l.prototype.deleteById=function(e,t,n){try{var a=this;if(null!=a.localDatabase&&null!=a.localDatabase.db){var s=a.localDatabase.db.transaction(e,"readwrite").objectStore(e);s.delete(t).onsuccess=function(e){n&&n(new c({success:!0,msg:"ok",result:null}))}}}catch(e){n&&n(new c({success:!1,msg:e,result:null}))}},l.prototype.clear=function(e,t){try{if(null!=me.localDatabase&&null!=me.localDatabase.db){var n=me.localDatabase.db.transaction(e,"readwrite").objectStore(e);n.clear().onsuccess=function(n){t&&t(new c({success:!0,msg:e+" object store cleared",result:null}))}}}catch(e){t&&t(new c({success:!1,msg:e,result:null}))}},l.prototype.updateById=function(e,t,n,a){try{var s=this,o=s.localDatabase.db.transaction(e,"readwrite"),r=o.objectStore(e),l=void 0;null!=s.localDatabase&&null!=s.localDatabase.db&&(r.get(t).onsuccess=function(t){l=t.target.result;for(var s in n)(l[s]||""==l[s])&&(l[s]=n[s]);var o=r.put(l);o.onsuccess=function(t){if(a){var n=[];n.push(l),a(new c({success:!0,msg:e+" store  "+JSON.stringify(l)+"  update",result:n}))}},o.onerror=function(e){a&&a(new c({success:!1,msg:e,result:null}))}})}catch(e){a&&a(new c({success:!1,msg:e,result:null}))}},t.DbHelper=l,t.Message=c,t.default=l},function(e,t,n){(function(e){!function(t){function n(e,t){if("object"!==s(e))return t;for(var a in t)"object"===s(e[a])&&"object"===s(t[a])?e[a]=n(e[a],t[a]):e[a]=t[a];return e}function a(e,t,a){var r=a[0],c=a.length;(e||"object"!==s(r))&&(r={});for(var l=0;l<c;++l){var u=a[l],i=s(u);if("object"===i)for(var f in u){var d=e?o.clone(u[f]):u[f];t?r[f]=n(r[f],d):r[f]=d}}return r}function s(e){return{}.toString.call(e).slice(8,-1).toLowerCase()}var o=function(e){return a(e===!0,!1,arguments)},r="merge";o.recursive=function(e){return a(e===!0,!0,arguments)},o.clone=function(e){var t,n,a=e,r=s(e);if("array"===r)for(a=[],n=e.length,t=0;t<n;++t)a[t]=o.clone(e[t]);else if("object"===r){a={};for(t in e)a[t]=o.clone(e[t])}return a},t?e.exports=o:window[r]=o}("object"==typeof e&&e&&"object"==typeof e.exports&&e.exports)}).call(t,n(2)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}}])});